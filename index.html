<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>a8fd5eab6429400b8c2a906ab70e95be</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="781c2bfb" class="cell markdown">
<h1 id="analysis-of-real-estate-sales-in-connecticut">Analysis of Real
Estate Sales in Connecticut</h1>
</div>
<div id="e9d54a8d" class="cell markdown">
<h5
id="collaborators-arin-zeng-helen-gu-jennifer-li-jason-chen">Collaborators:
Arin Zeng, Helen Gu, Jennifer Li, Jason Chen</h5>
<hr>
</div>
<div id="3f54e71c" class="cell markdown">
<h1 id="introduction">Introduction</h1>
</div>
<div id="b5094879" class="cell markdown">
<p>The main purpose of this project is to take you through the entire
pipeline of a data science journey. We will focus on how unemployment
rates, interest rates, location, among other factors, affect the sales
ratio of real estate homes in Connecticut. Amidst a nation where the
population is rapidly growing, homes and other real-estate properties
are increasing in demand while becoming a more popular investment area.
The real-estate market can appear to be a world of mystery, and
intimidating to navigate. As a home-buyer, you want to understand the
factors to weigh in to purchase or invest in real-estate; as a
home-seller, you want to understand the factors to weigh in to sell your
real-estate. We want to appeal to these two audiences in particular, as
we work to uncover the mystery surrounding the real-estate market. We
will be focusing on data sets specific to Connecticut, but our tutorial
will easily be applicable to studying the real-estate market in other
states.</p>
<p>The purpose of this tutorial is to analyze factors that affect sales
ratio in the real-estate market, and examine its relationship with
real-estate sales and profits. We will explore various methods of
graphing and visualizing possible relationships and trends in the data
to better understand the factors that impact the real-estate market.
Data science is a perfect tool for this task because it allows us to
easily unpack and organize messy and complicated data to synthesize more
digestible descriptions of the real-estate market that market
participants can refer to in their daily decisions.</p>
</div>
<div id="458672c9" class="cell markdown">
<h3 id="imports">Imports</h3>
</div>
<div id="ef661682" class="cell code" data-execution_count="272">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sodapy <span class="im">import</span> Socrata</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span></code></pre></div>
</div>
<div id="bca5129e" class="cell markdown">
<h2 id="data-collection-real-estate-sales">Data Collection: Real Estate
Sales</h2>
</div>
<div id="53652fde" class="cell markdown">
<p>The data science pipeline begins with collecting data for analysis.
We first extract data from a <a
href="https://data.ct.gov/Housing-and-Development/Real-Estate-Sales-2001-2020-GL/5mzw-sjtu">dataset
of Real estate sales</a> in Connecticut from the years 2001-2020,
provided by Connecticut Open Data. This data provides insight into the
sales prices of homes, what their assessed value was, when they were
sold, what the sales ratio was, and more. To retrieve the data, we use
an api client to get the records and store them into a dataframe for
further processing.</p>
</div>
<div id="22bcba20" class="cell markdown">
<p>!! Only run once !! <br> !! Start !!</p>
</div>
<div id="f8ded948" class="cell code" data-execution_count="273"
data-scrolled="true">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the library to set up api client connection with the Connecticut Open Data website</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> Socrata(<span class="st">&quot;data.ct.gov&quot;</span>, <span class="va">None</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns a JSON of records retrieved from the api up to 1000000 records since the </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset has a total of 997k records</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> client.get(<span class="st">&quot;5mzw-sjtu&quot;</span>, limit<span class="op">=</span><span class="dv">1000000</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to pandas DataFrame</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame.from_records(results)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>results_df.head()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>WARNING:root:Requests made without an app_token will be subject to strict throttling limits.
</code></pre>
</div>
<div class="output error" data-ename="KeyboardInterrupt" data-evalue="">
<pre><code>---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
Cell In[273], line 6
      2 client = Socrata(&quot;data.ct.gov&quot;, None)
      4 # Returns a JSON of records retrieved from the api up to 1000000 records since the 
      5 # dataset has a total of 997k records
----&gt; 6 results = client.get(&quot;5mzw-sjtu&quot;, limit=1000000)
      8 # Convert to pandas DataFrame
      9 results_df = pd.DataFrame.from_records(results)

File ~/Documents/cmsc320/lib/python3.10/site-packages/sodapy/socrata.py:412, in Socrata.get(self, dataset_identifier, content_type, **kwargs)
    409 params.update(kwargs)
    410 params = utils.clear_empty_values(params)
--&gt; 412 response = self._perform_request(
    413     &quot;get&quot;, resource, headers=headers, params=params
    414 )
    415 return response

File ~/Documents/cmsc320/lib/python3.10/site-packages/sodapy/socrata.py:551, in Socrata._perform_request(self, request_type, resource, **kwargs)
    548 # set a timeout, just to be safe
    549 kwargs[&quot;timeout&quot;] = self.timeout
--&gt; 551 response = getattr(self.session, request_type)(uri, **kwargs)
    553 # handle errors
    554 if response.status_code not in (200, 202):

File ~/Documents/cmsc320/lib/python3.10/site-packages/requests/sessions.py:600, in Session.get(self, url, **kwargs)
    592 r&quot;&quot;&quot;Sends a GET request. Returns :class:`Response` object.
    593 
    594 :param url: URL for the new :class:`Request` object.
    595 :param \*\*kwargs: Optional arguments that ``request`` takes.
    596 :rtype: requests.Response
    597 &quot;&quot;&quot;
    599 kwargs.setdefault(&quot;allow_redirects&quot;, True)
--&gt; 600 return self.request(&quot;GET&quot;, url, **kwargs)

File ~/Documents/cmsc320/lib/python3.10/site-packages/requests/sessions.py:587, in Session.request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)
    582 send_kwargs = {
    583     &quot;timeout&quot;: timeout,
    584     &quot;allow_redirects&quot;: allow_redirects,
    585 }
    586 send_kwargs.update(settings)
--&gt; 587 resp = self.send(prep, **send_kwargs)
    589 return resp

File ~/Documents/cmsc320/lib/python3.10/site-packages/requests/sessions.py:701, in Session.send(self, request, **kwargs)
    698 start = preferred_clock()
    700 # Send the request
--&gt; 701 r = adapter.send(request, **kwargs)
    703 # Total elapsed time of the request (approximately)
    704 elapsed = preferred_clock() - start

File ~/Documents/cmsc320/lib/python3.10/site-packages/requests/adapters.py:486, in HTTPAdapter.send(self, request, stream, timeout, verify, cert, proxies)
    483     timeout = TimeoutSauce(connect=timeout, read=timeout)
    485 try:
--&gt; 486     resp = conn.urlopen(
    487         method=request.method,
    488         url=url,
    489         body=request.body,
    490         headers=request.headers,
    491         redirect=False,
    492         assert_same_host=False,
    493         preload_content=False,
    494         decode_content=False,
    495         retries=self.max_retries,
    496         timeout=timeout,
    497         chunked=chunked,
    498     )
    500 except (ProtocolError, OSError) as err:
    501     raise ConnectionError(err, request=request)

File ~/Documents/cmsc320/lib/python3.10/site-packages/urllib3/connectionpool.py:790, in HTTPConnectionPool.urlopen(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, preload_content, decode_content, **response_kw)
    787 response_conn = conn if not release_conn else None
    789 # Make the request on the HTTPConnection object
--&gt; 790 response = self._make_request(
    791     conn,
    792     method,
    793     url,
    794     timeout=timeout_obj,
    795     body=body,
    796     headers=headers,
    797     chunked=chunked,
    798     retries=retries,
    799     response_conn=response_conn,
    800     preload_content=preload_content,
    801     decode_content=decode_content,
    802     **response_kw,
    803 )
    805 # Everything went great!
    806 clean_exit = True

File ~/Documents/cmsc320/lib/python3.10/site-packages/urllib3/connectionpool.py:536, in HTTPConnectionPool._make_request(self, conn, method, url, body, headers, retries, timeout, chunked, response_conn, preload_content, decode_content, enforce_content_length)
    534 # Receive the response from the server
    535 try:
--&gt; 536     response = conn.getresponse()
    537 except (BaseSSLError, OSError) as e:
    538     self._raise_timeout(err=e, url=url, timeout_value=read_timeout)

File ~/Documents/cmsc320/lib/python3.10/site-packages/urllib3/connection.py:454, in HTTPConnection.getresponse(self)
    451 from .response import HTTPResponse
    453 # Get the response from http.client.HTTPConnection
--&gt; 454 httplib_response = super().getresponse()
    456 try:
    457     assert_header_parsing(httplib_response.msg)

File /nix/store/pg1za7jn6cl9nlkvg51hclwxyiswiq34-python3-3.10.7/lib/python3.10/http/client.py:1374, in HTTPConnection.getresponse(self)
   1372 try:
   1373     try:
-&gt; 1374         response.begin()
   1375     except ConnectionError:
   1376         self.close()

File /nix/store/pg1za7jn6cl9nlkvg51hclwxyiswiq34-python3-3.10.7/lib/python3.10/http/client.py:318, in HTTPResponse.begin(self)
    316 # read until we get a non-100 response
    317 while True:
--&gt; 318     version, status, reason = self._read_status()
    319     if status != CONTINUE:
    320         break

File /nix/store/pg1za7jn6cl9nlkvg51hclwxyiswiq34-python3-3.10.7/lib/python3.10/http/client.py:279, in HTTPResponse._read_status(self)
    278 def _read_status(self):
--&gt; 279     line = str(self.fp.readline(_MAXLINE + 1), &quot;iso-8859-1&quot;)
    280     if len(line) &gt; _MAXLINE:
    281         raise LineTooLong(&quot;status line&quot;)

File /nix/store/pg1za7jn6cl9nlkvg51hclwxyiswiq34-python3-3.10.7/lib/python3.10/socket.py:705, in SocketIO.readinto(self, b)
    703 while True:
    704     try:
--&gt; 705         return self._sock.recv_into(b)
    706     except timeout:
    707         self._timeout_occurred = True

File /nix/store/pg1za7jn6cl9nlkvg51hclwxyiswiq34-python3-3.10.7/lib/python3.10/ssl.py:1274, in SSLSocket.recv_into(self, buffer, nbytes, flags)
   1270     if flags != 0:
   1271         raise ValueError(
   1272           &quot;non-zero flags not allowed in calls to recv_into() on %s&quot; %
   1273           self.__class__)
-&gt; 1274     return self.read(nbytes, buffer)
   1275 else:
   1276     return super().recv_into(buffer, nbytes, flags)

File /nix/store/pg1za7jn6cl9nlkvg51hclwxyiswiq34-python3-3.10.7/lib/python3.10/ssl.py:1130, in SSLSocket.read(self, len, buffer)
   1128 try:
   1129     if buffer is not None:
-&gt; 1130         return self._sslobj.read(len, buffer)
   1131     else:
   1132         return self._sslobj.read(len)

KeyboardInterrupt: 
</code></pre>
</div>
</div>
<div id="87bdfff6" class="cell markdown">
<p>Since the original dataset consists of over 990k data points, the
data takes much too long to filter and process, so we can take a
sampling of the data by selecting every hundredth row in order to reduce
the size of the dataset. Then the data is stored into a csv for ease of
future analysis.</p>
</div>
<div id="7ed7d38c" class="cell code">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take every hundredth row in the dataframe and save to a csv</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> results_df.iloc[::<span class="dv">100</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">&quot;conn_real_estate_sample.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div id="38bb8f96" class="cell markdown">
<p>!! End !!</p>
</div>
<div id="ff4a301d" class="cell code" data-scrolled="true">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read data into the dataframe from the csv file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/conn_real_estate_sample.csv&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>results_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="493">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>serialnumber</th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>geo_coordinates</th>
      <th>:@computed_region_dam5_q64j</th>
      <th>:@computed_region_nhmp_cq6b</th>
      <th>:@computed_region_m4y2_whse</th>
      <th>:@computed_region_snd5_k6zv</th>
      <th>nonusecode</th>
      <th>remarks</th>
      <th>opm_remarks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20001</td>
      <td>2020</td>
      <td>2020-10-05T00:00:00.000</td>
      <td>Andover</td>
      <td>303 LAKE RD</td>
      <td>121300</td>
      <td>210000.0</td>
      <td>0.577600</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>{'type': 'Point', 'coordinates': [-72.35327, 4...</td>
      <td>38.0</td>
      <td>246.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020072</td>
      <td>2020</td>
      <td>2020-11-25T00:00:00.000</td>
      <td>Ansonia</td>
      <td>7 JASON WRIGHT DR</td>
      <td>172500</td>
      <td>330000.0</td>
      <td>0.522700</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020221</td>
      <td>2020</td>
      <td>2021-05-25T00:00:00.000</td>
      <td>Ansonia</td>
      <td>8 BERKSHIRE RD</td>
      <td>108300</td>
      <td>245000.0</td>
      <td>0.442000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020361</td>
      <td>2020</td>
      <td>2021-09-21T00:00:00.000</td>
      <td>Ansonia</td>
      <td>5 BIRCHWOOD DR</td>
      <td>203700</td>
      <td>335000.0</td>
      <td>0.608000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200047</td>
      <td>2020</td>
      <td>2020-10-23T00:00:00.000</td>
      <td>Avon</td>
      <td>21 CLIFF DRIVE</td>
      <td>155390</td>
      <td>249000.0</td>
      <td>0.624000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>{'type': 'Point', 'coordinates': [-72.87619, 4...</td>
      <td>1041.0</td>
      <td>46.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7071</th>
      <td>10011</td>
      <td>2001</td>
      <td>2001-10-05T00:00:00.000</td>
      <td>Woodbury</td>
      <td>57 OLD GRASSY HL</td>
      <td>190630</td>
      <td>418962.0</td>
      <td>0.455005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7072</th>
      <td>10239</td>
      <td>2001</td>
      <td>2002-04-02T00:00:00.000</td>
      <td>Woodbury</td>
      <td>86 29 WASHINGTON RD</td>
      <td>36580</td>
      <td>80000.0</td>
      <td>0.457250</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7073</th>
      <td>10158</td>
      <td>2001</td>
      <td>2002-07-19T00:00:00.000</td>
      <td>Woodbury</td>
      <td>58 SHERMAN HTS</td>
      <td>96370</td>
      <td>240000.0</td>
      <td>0.401542</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7074</th>
      <td>10067</td>
      <td>2001</td>
      <td>2001-12-31T00:00:00.000</td>
      <td>Woodstock</td>
      <td>12 WAINWRIGHT DR</td>
      <td>67930</td>
      <td>146000.0</td>
      <td>0.465274</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7075</th>
      <td>10211</td>
      <td>2001</td>
      <td>2002-08-07T00:00:00.000</td>
      <td>Woodstock</td>
      <td>564 RT 198</td>
      <td>117550</td>
      <td>199500.0</td>
      <td>0.589223</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'type': 'Point', 'coordinates': [-72.07593, 4...</td>
      <td>39.0</td>
      <td>72.0</td>
      <td>169.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>7076 rows × 18 columns</p>
</div>
</div>
</div>
<div id="740b81c8" class="cell markdown">
<h2 id="data-processing-real-estate-sales">Data Processing: Real Estate
Sales</h2>
</div>
<div id="09ea7131" class="cell markdown">
<p>Now that we have the data, our next step is to clean up our data in
order to get rid of unnecessary columns or rows, as well as extraneous
values. Looking at the table, there are multiple columns that don't
quite seem to make sense as well as columns that have little effect on
our analysis such as serial number, computed regions, and remarks. So we
can go ahead and drop these columns from our dataframe since we don't
need them going forward. Within some columns, there is also data where
all the information is included, but it is formatted in a way that is
difficult for us to process or includes extra data. For example, the
date recorded field includes the time of the record as well; however it
appears to be 00:00:00 for every entry and since it is the date that we
are looking at, the time is not pertinent to this field, so we can strip
the time from the date field to clean it up. We also separate out the
year and the month into new fields of their own for more general
analysis.</p>
</div>
<div id="e5488728" class="cell code" data-scrolled="true">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop unnecessary columns</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> results_df.drop(columns <span class="op">=</span> [<span class="st">&#39;serialnumber&#39;</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;:@computed_region_dam5_q64j&#39;</span>, <span class="st">&#39;:@computed_region_nhmp_cq6b&#39;</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;:@computed_region_m4y2_whse&#39;</span>, <span class="st">&#39;:@computed_region_snd5_k6zv&#39;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;remarks&#39;</span>, <span class="st">&#39;opm_remarks&#39;</span>])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># strip time from date string</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;daterecorded&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;daterecorded&#39;</span>].<span class="bu">str</span>[:<span class="dv">10</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># separate date into two fields and convert into datetime objects</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Year&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;daterecorded&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>).dt.strftime(<span class="st">&#39;%Y&#39;</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;daterecorded&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>).dt.strftime(<span class="st">&#39;%m&#39;</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="494">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>geo_coordinates</th>
      <th>nonusecode</th>
      <th>Year</th>
      <th>Month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>2020-10-05</td>
      <td>Andover</td>
      <td>303 LAKE RD</td>
      <td>121300</td>
      <td>210000.0</td>
      <td>0.577600</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>{'type': 'Point', 'coordinates': [-72.35327, 4...</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>2020-11-25</td>
      <td>Ansonia</td>
      <td>7 JASON WRIGHT DR</td>
      <td>172500</td>
      <td>330000.0</td>
      <td>0.522700</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2020</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>2021-05-25</td>
      <td>Ansonia</td>
      <td>8 BERKSHIRE RD</td>
      <td>108300</td>
      <td>245000.0</td>
      <td>0.442000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021</td>
      <td>05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>2021-09-21</td>
      <td>Ansonia</td>
      <td>5 BIRCHWOOD DR</td>
      <td>203700</td>
      <td>335000.0</td>
      <td>0.608000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021</td>
      <td>09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>2020-10-23</td>
      <td>Avon</td>
      <td>21 CLIFF DRIVE</td>
      <td>155390</td>
      <td>249000.0</td>
      <td>0.624000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>{'type': 'Point', 'coordinates': [-72.87619, 4...</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7071</th>
      <td>2001</td>
      <td>2001-10-05</td>
      <td>Woodbury</td>
      <td>57 OLD GRASSY HL</td>
      <td>190630</td>
      <td>418962.0</td>
      <td>0.455005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2001</td>
      <td>10</td>
    </tr>
    <tr>
      <th>7072</th>
      <td>2001</td>
      <td>2002-04-02</td>
      <td>Woodbury</td>
      <td>86 29 WASHINGTON RD</td>
      <td>36580</td>
      <td>80000.0</td>
      <td>0.457250</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>04</td>
    </tr>
    <tr>
      <th>7073</th>
      <td>2001</td>
      <td>2002-07-19</td>
      <td>Woodbury</td>
      <td>58 SHERMAN HTS</td>
      <td>96370</td>
      <td>240000.0</td>
      <td>0.401542</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>07</td>
    </tr>
    <tr>
      <th>7074</th>
      <td>2001</td>
      <td>2001-12-31</td>
      <td>Woodstock</td>
      <td>12 WAINWRIGHT DR</td>
      <td>67930</td>
      <td>146000.0</td>
      <td>0.465274</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2001</td>
      <td>12</td>
    </tr>
    <tr>
      <th>7075</th>
      <td>2001</td>
      <td>2002-08-07</td>
      <td>Woodstock</td>
      <td>564 RT 198</td>
      <td>117550</td>
      <td>199500.0</td>
      <td>0.589223</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'type': 'Point', 'coordinates': [-72.07593, 4...</td>
      <td>NaN</td>
      <td>2002</td>
      <td>08</td>
    </tr>
  </tbody>
</table>
<p>7076 rows × 13 columns</p>
</div>
</div>
</div>
<div id="f5297ca4" class="cell markdown">
<p>Another step we can take is to separate out the x and y coordinates
for the geo coordinates field. The geo coordinates field also has
encoded all necessary information; however, the formatting of the field
makes it difficult for us to directly examine the coordinate
information. So in order to extract the coordinate information, we can
use string operations to extract the x and y coordinates, which are
placed into their own respective fields. This way, we can better examine
where the coordinates of a specific record belong.</p>
</div>
<div id="c3fbdd5b" class="cell code">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the coordinates from the geo coordinates field and separate into x and y coordinates</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;coord&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;geo_coordinates&#39;</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.extract(<span class="st">&#39;\[(.*?)\]&#39;</span>, expand<span class="op">=</span><span class="va">False</span>).<span class="bu">str</span>.strip()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;x_coord&#39;</span>,<span class="st">&#39;y_coord&#39;</span>]] <span class="op">=</span> df.coord.<span class="bu">str</span>.split(<span class="st">&quot;, &quot;</span>,expand<span class="op">=</span><span class="va">True</span>).astype(<span class="bu">float</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns <span class="op">=</span> [<span class="st">&#39;geo_coordinates&#39;</span>, <span class="st">&#39;coord&#39;</span>])</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="495">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>nonusecode</th>
      <th>Year</th>
      <th>Month</th>
      <th>x_coord</th>
      <th>y_coord</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>2020-10-05</td>
      <td>Andover</td>
      <td>303 LAKE RD</td>
      <td>121300</td>
      <td>210000.0</td>
      <td>0.5776</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.35327</td>
      <td>41.71416</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>2020-11-25</td>
      <td>Ansonia</td>
      <td>7 JASON WRIGHT DR</td>
      <td>172500</td>
      <td>330000.0</td>
      <td>0.5227</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>2021-05-25</td>
      <td>Ansonia</td>
      <td>8 BERKSHIRE RD</td>
      <td>108300</td>
      <td>245000.0</td>
      <td>0.4420</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2021</td>
      <td>05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>2021-09-21</td>
      <td>Ansonia</td>
      <td>5 BIRCHWOOD DR</td>
      <td>203700</td>
      <td>335000.0</td>
      <td>0.6080</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2021</td>
      <td>09</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>2020-10-23</td>
      <td>Avon</td>
      <td>21 CLIFF DRIVE</td>
      <td>155390</td>
      <td>249000.0</td>
      <td>0.6240</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.87619</td>
      <td>41.80986</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="c2e34564" class="cell markdown">
<p>An important part of examining the data is also to look at the
distribution of data to make sure that our data has a good distribution
of records and also doesn't include any extraneous values. This we can
see in a summary of the dataframe seen below. Most of the data appears
to be normal; however, in our sales ratio, there is clearly a max value
that lies far beyond the range of the other sales ratio values. We can
confirm that it is an outlier by calculating the third quartile + (1.5 *
IQR) which gives us an upper fence where outliers would lie beyond. The
third quartile + (1.5 * IQR) is equal to 0.70 + 1.5(0.70 - 0.49) =
1.015, so it is evident that this data point, the max of 7.9 is an
outlier and we can remove it from the dataset and also use this upper
fence to filter out unreasonably high values.</p>
</div>
<div id="e6713ef7" class="cell code">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display a summary of the dataframe</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="496">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>nonusecode</th>
      <th>x_coord</th>
      <th>y_coord</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7076.000000</td>
      <td>7.076000e+03</td>
      <td>7.076000e+03</td>
      <td>7076.000000</td>
      <td>0.0</td>
      <td>1403.000000</td>
      <td>1403.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2009.954211</td>
      <td>2.306462e+05</td>
      <td>3.838914e+05</td>
      <td>0.606059</td>
      <td>NaN</td>
      <td>-72.887949</td>
      <td>41.485677</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.366022</td>
      <td>4.231461e+05</td>
      <td>7.206351e+05</td>
      <td>0.195015</td>
      <td>NaN</td>
      <td>0.428388</td>
      <td>0.258001</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2001.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>-73.671740</td>
      <td>41.012320</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2004.000000</td>
      <td>9.281500e+04</td>
      <td>1.670000e+05</td>
      <td>0.485414</td>
      <td>NaN</td>
      <td>-73.221735</td>
      <td>41.280930</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2009.000000</td>
      <td>1.449950e+05</td>
      <td>2.470000e+05</td>
      <td>0.597535</td>
      <td>NaN</td>
      <td>-72.907140</td>
      <td>41.483920</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2016.000000</td>
      <td>2.329325e+05</td>
      <td>3.821250e+05</td>
      <td>0.704150</td>
      <td>NaN</td>
      <td>-72.634795</td>
      <td>41.709425</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2020.000000</td>
      <td>1.540000e+07</td>
      <td>2.489893e+07</td>
      <td>7.915833</td>
      <td>NaN</td>
      <td>-71.810420</td>
      <td>42.033330</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="f852e257" class="cell code">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove sales ratio outliers</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">&#39;salesratio&#39;</span>] <span class="op">&lt;</span> <span class="fl">1.015</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="497">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>nonusecode</th>
      <th>Year</th>
      <th>Month</th>
      <th>x_coord</th>
      <th>y_coord</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>2020-10-05</td>
      <td>Andover</td>
      <td>303 LAKE RD</td>
      <td>121300</td>
      <td>210000.0</td>
      <td>0.577600</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.35327</td>
      <td>41.71416</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>2020-11-25</td>
      <td>Ansonia</td>
      <td>7 JASON WRIGHT DR</td>
      <td>172500</td>
      <td>330000.0</td>
      <td>0.522700</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>2021-05-25</td>
      <td>Ansonia</td>
      <td>8 BERKSHIRE RD</td>
      <td>108300</td>
      <td>245000.0</td>
      <td>0.442000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2021</td>
      <td>05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>2021-09-21</td>
      <td>Ansonia</td>
      <td>5 BIRCHWOOD DR</td>
      <td>203700</td>
      <td>335000.0</td>
      <td>0.608000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2021</td>
      <td>09</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>2020-10-23</td>
      <td>Avon</td>
      <td>21 CLIFF DRIVE</td>
      <td>155390</td>
      <td>249000.0</td>
      <td>0.624000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.87619</td>
      <td>41.80986</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7071</th>
      <td>2001</td>
      <td>2001-10-05</td>
      <td>Woodbury</td>
      <td>57 OLD GRASSY HL</td>
      <td>190630</td>
      <td>418962.0</td>
      <td>0.455005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2001</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7072</th>
      <td>2001</td>
      <td>2002-04-02</td>
      <td>Woodbury</td>
      <td>86 29 WASHINGTON RD</td>
      <td>36580</td>
      <td>80000.0</td>
      <td>0.457250</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>04</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7073</th>
      <td>2001</td>
      <td>2002-07-19</td>
      <td>Woodbury</td>
      <td>58 SHERMAN HTS</td>
      <td>96370</td>
      <td>240000.0</td>
      <td>0.401542</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>07</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7074</th>
      <td>2001</td>
      <td>2001-12-31</td>
      <td>Woodstock</td>
      <td>12 WAINWRIGHT DR</td>
      <td>67930</td>
      <td>146000.0</td>
      <td>0.465274</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2001</td>
      <td>12</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7075</th>
      <td>2001</td>
      <td>2002-08-07</td>
      <td>Woodstock</td>
      <td>564 RT 198</td>
      <td>117550</td>
      <td>199500.0</td>
      <td>0.589223</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>08</td>
      <td>-72.07593</td>
      <td>41.95063</td>
    </tr>
  </tbody>
</table>
<p>6954 rows × 14 columns</p>
</div>
</div>
</div>
<div id="1640f2bd" class="cell markdown">
<h2 id="data-collection-interest-rates">Data Collection: Interest
Rates</h2>
</div>
<div id="6a9dfa73" class="cell markdown">
<p>In order to better gauge factors that affect real estate sales, we
can take a look at historical interest rates and how they fit in with
our real estate data. Since interest rates commonly affect the market
and how people buy and sell, it can be useful to examine interest rates
in relation to the real estate sales to determine what kind of
relationship exists interest rates and real estate sales.</p>
</div>
<div id="75210ba5" class="cell markdown">
<p>Another method of acquiring data is to scrape it from websites. Since
First Republic provides a table of historical interest rates on their
website, we can scrape the interest rates off their website using
webscraping libraries like selenium and BeautifulSoup. Once the html
from the page has been scraped, we can then parse the html to identify
the table and pick out the data that we need from the table. Web
scraping is a useful technique for gathering data from websites online
where the dataset may not be available to download and is commonly used
for data collection. Check out more information on webscraping using
selenium and BeautifulSoup <a
href="https://medium.com/ymedialabs-innovation/web-scraping-using-beautiful-soup-and-selenium-for-dynamic-page-2f8ad15efe25#:~:text=The%20combination%20of%20Beautiful%20Soup,be%20extracted%20by%20Beautiful%20Soup">here</a>.</p>
</div>
<div id="9611817f" class="cell code">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># url of the page we are scraping</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&quot;https://www.firstrepublic.com/finmkts/historical-interest-rates&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initiating the webdriver. Parameter includes the path of the webdriver.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>driver <span class="op">=</span> webdriver.Chrome(<span class="st">&#39;./chromedriver&#39;</span>) </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>driver.get(url) </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ensures that the page is loaded</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>time.sleep(<span class="dv">5</span>) </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># gets the html of the page</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>html <span class="op">=</span> driver.page_source</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># apply bs4 to html variable</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(html, <span class="st">&quot;html.parser&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>C:\Users\helen\AppData\Local\Temp\ipykernel_14968\1535766723.py:4: DeprecationWarning: executable_path has been deprecated, please pass in a Service object
</code></pre>
</div>
</div>
<div id="6aedf606" class="cell code">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find all table tag in the html</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> soup.find_all(<span class="st">&quot;table&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># take the third table tag and isolate only the necessary data and divide</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the data into rows</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> <span class="bu">str</span>(table[<span class="dv">2</span>]).split(<span class="st">&quot;&lt;tbody&gt;&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> arr[<span class="dv">1</span>].split(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> arr[<span class="op">-</span><span class="dv">2</span>].split(<span class="st">&quot;&lt;tr&gt;&quot;</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> arr[<span class="dv">1</span>:]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make a dataframe</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame(arr)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over the dataframe</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> df1.iterrows():</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># split the entries</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> row[<span class="dv">0</span>].split(<span class="st">&quot;&lt;td&gt;&quot;</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the month/year value</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> arr[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">5</span>]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># break if outside of our date range</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> date[<span class="op">-</span><span class="dv">4</span>:] <span class="op">==</span> <span class="st">&#39;2000&#39;</span>:</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the interest rate</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    prime_rate <span class="op">=</span> <span class="bu">float</span>(arr[<span class="dv">4</span>][:<span class="op">-</span><span class="dv">11</span>])</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># parse the date and split into year and month</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    df1.at[i, <span class="st">&#39;Year&#39;</span>] <span class="op">=</span> pd.to_datetime(date, <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%m/%Y&quot;</span>).year</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    df1.at[i, <span class="st">&#39;Month&#39;</span>] <span class="op">=</span> pd.to_datetime(date, <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%m/%Y&quot;</span>).month</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set the interest rate</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    df1.at[i, <span class="st">&#39;primeRate&#39;</span>] <span class="op">=</span> prime_rate</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co"># drop all na values and unnecessary columns</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>df1.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>df1.drop(columns<span class="op">=</span>[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co"># cast types</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Year&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Year&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>df1[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> df1[<span class="st">&#39;Month&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co"># write to csv</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>df_rate <span class="op">=</span> df1.copy()</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>df_rate.to_csv(<span class="st">&quot;data/conn_interest_rate.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>df_rate</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output execute_result" data-execution_count="499">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>primeRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2023</td>
      <td>3</td>
      <td>7.75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2023</td>
      <td>2</td>
      <td>7.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2023</td>
      <td>1</td>
      <td>7.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022</td>
      <td>12</td>
      <td>7.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022</td>
      <td>11</td>
      <td>7.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>262</th>
      <td>2001</td>
      <td>5</td>
      <td>7.50</td>
    </tr>
    <tr>
      <th>263</th>
      <td>2001</td>
      <td>4</td>
      <td>7.50</td>
    </tr>
    <tr>
      <th>264</th>
      <td>2001</td>
      <td>3</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>265</th>
      <td>2001</td>
      <td>2</td>
      <td>8.50</td>
    </tr>
    <tr>
      <th>266</th>
      <td>2001</td>
      <td>1</td>
      <td>9.00</td>
    </tr>
  </tbody>
</table>
<p>267 rows × 3 columns</p>
</div>
</div>
</div>
<div id="44968773" class="cell code">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if web driver error</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df_rate <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/conn_interest_rate.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="d1360dac" class="cell markdown">
<h2 id="data-collection-unemployment-rates">Data Collection:
Unemployment Rates</h2>
</div>
<div id="1b74522f" class="cell markdown">
<p>Another factor that appears to impact the real estate market is the
state of the economy which correlates to unemployment rates. It is also
possible that with higher unemployment rates, there will be less people
who are financially capable of purchasing real estate, resulting in
lower sales. To analyze whether a relationship truly exists between
unemployment rates real estate sales, we first start by collecting data
on unemployment rates. The U.S. Bureau of Labor Statistics provides a <a
href="https://data.bls.gov/pdq/SurveyOutputServlet">dataset of labor
statistics</a> which we use below.</p>
</div>
<div id="b0e5ed4c" class="cell code">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read unemployment data into the dataframe</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>unemployment_df <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/conn_unemployment.csv&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>unemployment_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="501">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Jan</th>
      <th>Feb</th>
      <th>Mar</th>
      <th>Apr</th>
      <th>May</th>
      <th>Jun</th>
      <th>Jul</th>
      <th>Aug</th>
      <th>Sep</th>
      <th>Oct</th>
      <th>Nov</th>
      <th>Dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>2.3</td>
      <td>2.4</td>
      <td>2.5</td>
      <td>2.6</td>
      <td>2.7</td>
      <td>2.8</td>
      <td>2.9</td>
      <td>3.0</td>
      <td>3.1</td>
      <td>3.3</td>
      <td>3.4</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2002</td>
      <td>3.6</td>
      <td>3.8</td>
      <td>3.9</td>
      <td>4.1</td>
      <td>4.2</td>
      <td>4.3</td>
      <td>4.5</td>
      <td>4.6</td>
      <td>4.8</td>
      <td>4.9</td>
      <td>5.0</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2003</td>
      <td>5.2</td>
      <td>5.3</td>
      <td>5.4</td>
      <td>5.5</td>
      <td>5.5</td>
      <td>5.6</td>
      <td>5.6</td>
      <td>5.6</td>
      <td>5.5</td>
      <td>5.5</td>
      <td>5.4</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004</td>
      <td>5.3</td>
      <td>5.3</td>
      <td>5.2</td>
      <td>5.2</td>
      <td>5.2</td>
      <td>5.1</td>
      <td>5.1</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.9</td>
      <td>4.9</td>
      <td>4.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2005</td>
      <td>4.9</td>
      <td>4.9</td>
      <td>4.9</td>
      <td>4.9</td>
      <td>4.8</td>
      <td>4.8</td>
      <td>4.8</td>
      <td>4.8</td>
      <td>4.8</td>
      <td>4.7</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="7dd00bb4" class="cell markdown">
<p>Looking at the data, we can see the current unemployment data is not
tidy, because we do not fit the criteria for tidy data which includes
the following principles of tidy data:</p>
<ol>
<li>Every column is a variable</li>
<li>Every row is an observation</li>
<li>Every cell is a single value</li>
</ol>
<p>To make the unemployment data tidy, we need to convert our columns
into rows. This can be done in an process called melting which makes it
so that the months become values and we end up with the year, month, and
unemployment rate as columns. To learn more about tidy data click <a
href="http://vita.had.co.nz/papers/tidy-data.pdf">here</a>.</p>
</div>
<div id="a614f1e7" class="cell code">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the columns of the dataframe</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>unemployment_df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="502">
<pre><code>Index([&#39;Year&#39;, &#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;, &#39;May&#39;, &#39;Jun&#39;, &#39;Jul&#39;, &#39;Aug&#39;, &#39;Sep&#39;,
       &#39;Oct&#39;, &#39;Nov&#39;, &#39;Dec&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div id="9b21dcd1" class="cell code">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># melt the dataframe</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>unemployment_df <span class="op">=</span> pd.melt(unemployment_df, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        id_vars<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>], </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        value_vars<span class="op">=</span>[<span class="st">&#39;Jan&#39;</span>, <span class="st">&#39;Feb&#39;</span>, <span class="st">&#39;Mar&#39;</span>, <span class="st">&#39;Apr&#39;</span>, <span class="st">&#39;May&#39;</span>, <span class="st">&#39;Jun&#39;</span>, <span class="st">&#39;Jul&#39;</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Aug&#39;</span>, <span class="st">&#39;Sep&#39;</span>, <span class="st">&#39;Oct&#39;</span>, <span class="st">&#39;Nov&#39;</span>, <span class="st">&#39;Dec&#39;</span>],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        var_name<span class="op">=</span><span class="st">&#39;Month&#39;</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        value_name<span class="op">=</span><span class="st">&#39;UnemploymentRate&#39;</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># drop missing values</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>unemployment_df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>unemployment_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="503">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>UnemploymentRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>Jan</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2002</td>
      <td>Jan</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2003</td>
      <td>Jan</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004</td>
      <td>Jan</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2005</td>
      <td>Jan</td>
      <td>4.9</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="d9a70adf" class="cell code">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># array of months</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>months <span class="op">=</span> [<span class="st">&#39;Jan&#39;</span>, <span class="st">&#39;Feb&#39;</span>, <span class="st">&#39;Mar&#39;</span>, <span class="st">&#39;Apr&#39;</span>, <span class="st">&#39;May&#39;</span>, <span class="st">&#39;Jun&#39;</span>, <span class="st">&#39;Jul&#39;</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Aug&#39;</span>, <span class="st">&#39;Sep&#39;</span>, <span class="st">&#39;Oct&#39;</span>, <span class="st">&#39;Nov&#39;</span>, <span class="st">&#39;Dec&#39;</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># format the year and month into datetime objects</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> unemployment_df.iterrows():</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    unemployment_df.at[i, <span class="st">&#39;Year&#39;</span>] <span class="op">=</span> pd.to_datetime(row[<span class="st">&#39;Year&#39;</span>], <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%Y&quot;</span>).year</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    unemployment_df.at[i, <span class="st">&#39;Month&#39;</span>] <span class="op">=</span> pd.to_datetime((<span class="bu">int</span>(months.index(row[<span class="st">&#39;Month&#39;</span>])) <span class="op">+</span> <span class="dv">1</span>), <span class="bu">format</span><span class="op">=</span><span class="st">&quot;%m&quot;</span>).month</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>unemployment_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="504">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>UnemploymentRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>1</td>
      <td>2.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2002</td>
      <td>1</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2003</td>
      <td>1</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004</td>
      <td>1</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2005</td>
      <td>1</td>
      <td>4.9</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="6ffe3aef" class="cell markdown">
<p>Now that we have retrieved real estate sales data, interest rate
data, and unemployment rate data, we can combine all the datasets into
one dataset, where we compare the year and the month to insert the
correct unemployment rate and interest rate. To do this, we can perform
a join using the pandas merge function and join on the columns year and
month, since those are the columns that we want to be cross referenced
when merging the datasets. Joining datasets is an essential part of
being able to compare data across different datasets. Learn more about
joins <a
href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html">here</a>.</p>
</div>
<div id="c750c5af" class="cell code">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop missing values</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_copy <span class="op">=</span> df.copy().dropna(subset<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Month&#39;</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">&#39;Year&#39;</span>] <span class="op">=</span> df_copy[<span class="st">&#39;Year&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>df_copy[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> df_copy[<span class="st">&#39;Month&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># join the real estate data and unemployment data</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>df_merge <span class="op">=</span> pd.merge(df_copy, unemployment_df, on<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Month&#39;</span>])</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>df_merge</span></code></pre></div>
<div class="output execute_result" data-execution_count="505">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>nonusecode</th>
      <th>Year</th>
      <th>Month</th>
      <th>x_coord</th>
      <th>y_coord</th>
      <th>UnemploymentRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>2020-10-05</td>
      <td>Andover</td>
      <td>303 LAKE RD</td>
      <td>121300</td>
      <td>210000.0</td>
      <td>0.577600</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.35327</td>
      <td>41.71416</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>2020-10-23</td>
      <td>Avon</td>
      <td>21 CLIFF DRIVE</td>
      <td>155390</td>
      <td>249000.0</td>
      <td>0.624000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.87619</td>
      <td>41.80986</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>2020-10-09</td>
      <td>Beacon Falls</td>
      <td>19 SUSAN STREET</td>
      <td>32640</td>
      <td>45000.0</td>
      <td>0.725300</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>2020-10-13</td>
      <td>Bethel</td>
      <td>57 CHESTNUT STREET</td>
      <td>194110</td>
      <td>365000.0</td>
      <td>0.531800</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-73.40632</td>
      <td>41.36916</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>2020-10-21</td>
      <td>Branford</td>
      <td>2E ANCHOR REEF</td>
      <td>256000</td>
      <td>480000.0</td>
      <td>0.533300</td>
      <td>Residential</td>
      <td>Condo</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.67344</td>
      <td>41.72606</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6948</th>
      <td>2001</td>
      <td>2002-03-20</td>
      <td>Torrington</td>
      <td>616 MIGEON AVE UT 10</td>
      <td>17100</td>
      <td>32900.0</td>
      <td>0.519757</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>6949</th>
      <td>2001</td>
      <td>2002-03-25</td>
      <td>Trumbull</td>
      <td>6 PEPPERIDGE RD</td>
      <td>168500</td>
      <td>309900.0</td>
      <td>0.543724</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>6950</th>
      <td>2001</td>
      <td>2002-03-01</td>
      <td>Westport</td>
      <td>92 NEWTOWN TPKE</td>
      <td>385900</td>
      <td>635000.0</td>
      <td>0.607717</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>6951</th>
      <td>2001</td>
      <td>2002-03-11</td>
      <td>Wethersfield</td>
      <td>703 RIDGE RD</td>
      <td>131400</td>
      <td>245000.0</td>
      <td>0.536327</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>6952</th>
      <td>2001</td>
      <td>2002-03-27</td>
      <td>Woodbridge</td>
      <td>27 RICHARD SWEET DR</td>
      <td>307650</td>
      <td>439000.0</td>
      <td>0.700797</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
    </tr>
  </tbody>
</table>
<p>6953 rows × 15 columns</p>
</div>
</div>
</div>
<div id="89ad20dc" class="cell code">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># join the merged datasets and also the interest rate dataset to combine all three datasets</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_merge <span class="op">=</span> pd.merge(df_merge, df_rate, on<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Month&#39;</span>])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df_merge</span></code></pre></div>
<div class="output execute_result" data-execution_count="506">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>nonusecode</th>
      <th>Year</th>
      <th>Month</th>
      <th>x_coord</th>
      <th>y_coord</th>
      <th>UnemploymentRate</th>
      <th>primeRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>2020-10-05</td>
      <td>Andover</td>
      <td>303 LAKE RD</td>
      <td>121300</td>
      <td>210000.0</td>
      <td>0.577600</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.35327</td>
      <td>41.71416</td>
      <td>7.9</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>2020-10-23</td>
      <td>Avon</td>
      <td>21 CLIFF DRIVE</td>
      <td>155390</td>
      <td>249000.0</td>
      <td>0.624000</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.87619</td>
      <td>41.80986</td>
      <td>7.9</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>2020-10-09</td>
      <td>Beacon Falls</td>
      <td>19 SUSAN STREET</td>
      <td>32640</td>
      <td>45000.0</td>
      <td>0.725300</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.9</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>2020-10-13</td>
      <td>Bethel</td>
      <td>57 CHESTNUT STREET</td>
      <td>194110</td>
      <td>365000.0</td>
      <td>0.531800</td>
      <td>Residential</td>
      <td>Single Family</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-73.40632</td>
      <td>41.36916</td>
      <td>7.9</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>2020-10-21</td>
      <td>Branford</td>
      <td>2E ANCHOR REEF</td>
      <td>256000</td>
      <td>480000.0</td>
      <td>0.533300</td>
      <td>Residential</td>
      <td>Condo</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.67344</td>
      <td>41.72606</td>
      <td>7.9</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6948</th>
      <td>2001</td>
      <td>2002-03-20</td>
      <td>Torrington</td>
      <td>616 MIGEON AVE UT 10</td>
      <td>17100</td>
      <td>32900.0</td>
      <td>0.519757</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>6949</th>
      <td>2001</td>
      <td>2002-03-25</td>
      <td>Trumbull</td>
      <td>6 PEPPERIDGE RD</td>
      <td>168500</td>
      <td>309900.0</td>
      <td>0.543724</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>6950</th>
      <td>2001</td>
      <td>2002-03-01</td>
      <td>Westport</td>
      <td>92 NEWTOWN TPKE</td>
      <td>385900</td>
      <td>635000.0</td>
      <td>0.607717</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>6951</th>
      <td>2001</td>
      <td>2002-03-11</td>
      <td>Wethersfield</td>
      <td>703 RIDGE RD</td>
      <td>131400</td>
      <td>245000.0</td>
      <td>0.536327</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>6952</th>
      <td>2001</td>
      <td>2002-03-27</td>
      <td>Woodbridge</td>
      <td>27 RICHARD SWEET DR</td>
      <td>307650</td>
      <td>439000.0</td>
      <td>0.700797</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.9</td>
      <td>4.75</td>
    </tr>
  </tbody>
</table>
<p>6953 rows × 16 columns</p>
</div>
</div>
</div>
<div id="77a68bfb" class="cell markdown">
<h2 id="exploratory-analysis--data-visualization">Exploratory Analysis
&amp; Data Visualization</h2>
</div>
<div id="cfa83317" class="cell markdown">
<p>First, let's get a feel for exploring the various factors that may
affect the sales ratio of real-estate units in Connecticut. We will
explore the residential types of the units, creating a dataframe that
shows the number of each residential type {Condo, Single Family, Two
Family, Three Family, Four Family} for each town. To do so, we will need
to create a unique list of residential types, capture the number of
real-estate units that match each residential type, and create a new
column to display the collective counts.</p>
</div>
<div id="3468c761" class="cell code">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a unique list of the residential types</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cleanedList <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> results_df.residentialtype.unique() <span class="cf">if</span> x <span class="op">==</span> x]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with just the town and residential type columns</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>residential_df <span class="op">=</span> results_df[[<span class="st">&#39;town&#39;</span>,<span class="st">&#39;residentialtype&#39;</span>]]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plus residential type counts for each town</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>count_resident_df <span class="op">=</span> residential_df.groupby([<span class="st">&#39;town&#39;</span>,<span class="st">&#39;residentialtype&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Shows the amount of each residential type for each town where each column is a residential type and another column for the town </span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>residential_df <span class="op">=</span> count_resident_df.pivot_table(values<span class="op">=</span><span class="st">&#39;count&#39;</span>, index<span class="op">=</span><span class="st">&#39;town&#39;</span>, columns<span class="op">=</span><span class="st">&#39;residentialtype&#39;</span>,fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> residential_df</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>residential_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="322">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>residentialtype</th>
      <th>Condo</th>
      <th>Four Family</th>
      <th>Single Family</th>
      <th>Three Family</th>
      <th>Two Family</th>
    </tr>
    <tr>
      <th>town</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Andover</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Ansonia</th>
      <td>0</td>
      <td>0</td>
      <td>17</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Ashford</th>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Avon</th>
      <td>11</td>
      <td>0</td>
      <td>29</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Barkhamsted</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Windsor Locks</th>
      <td>6</td>
      <td>0</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Wolcott</th>
      <td>1</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Woodbridge</th>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Woodbury</th>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Woodstock</th>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>166 rows × 5 columns</p>
</div>
</div>
</div>
<div id="704f2094" class="cell markdown">
<p>Now that we've organized this data to show the number of each
residential types for each town, let's make a graph to better visualize
the data. We can make a bar graph to visualize the average sales ratio
vs each residential type. We'll start by grouping entries with the same
residential type, and aggregating their sales ratios to calculate their
mean/average value.</p>
</div>
<div id="500b96cf" class="cell code">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># real-estate unit entries grouped by their residential type vs and average sales ratio</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>residential_df <span class="op">=</span> results_df.groupby(<span class="st">&#39;residentialtype&#39;</span>).agg({<span class="st">&#39;salesratio&#39;</span>: <span class="st">&#39;mean&#39;</span>})</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># made into a bar graph</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>residential_df.plot.bar(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Sales Ratio by Residential Type&#39;</span>, ylabel<span class="op">=</span><span class="st">&#39;Sales Ratio&#39;</span>, xlabel<span class="op">=</span><span class="st">&#39;Town&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="323">
<pre><code>&lt;Axes: title={&#39;center&#39;: &#39;Sales Ratio by Residential Type&#39;}, xlabel=&#39;Town&#39;, ylabel=&#39;Sales Ratio&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/97213d5589fa4276b0965fb967fdeccf6635ae26.png" /></p>
</div>
</div>
<div id="23074bb1" class="cell markdown">
<p>As we can see from this bar graph, sales ratio falls consistently
within a tight range of 0.53 and 0.68 across the five residential types,
suggesting that there is a weak or no relationship between residential
type and sales ratio. Moving forward, we can infer that residential type
has little effect on sales ratio, and is a weak factor if at all for
sales ratio.</p>
</div>
<div id="533ff382" class="cell markdown">
<p>Next, we will examine the relationship of location and the average
sale ratio of homes. We will first make a bar graph of towns vs their
average sales ratio, and then we will look at how sales ratio differs
with locations not guided by town borders using a map. Let's start by
making a bar graph with the town and salesratio columns!</p>
</div>
<div id="fb1af68e" class="cell code" data-scrolled="true">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make table with just town and salesratio columns</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df_merge[[<span class="st">&#39;town&#39;</span>, <span class="st">&#39;salesratio&#39;</span>]]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert all salesratio values to floats</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">&#39;salesratio&#39;</span>] <span class="op">=</span> df4[<span class="st">&#39;salesratio&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># group by town and average the salesratio</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df4.groupby(<span class="st">&#39;town&#39;</span>).mean()</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the rows where town is &#39;***Unknown***&#39;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df4[df4.index <span class="op">!=</span> <span class="st">&#39;***Unknown***&#39;</span>]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>df4.head()</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graph with town vs salesratio</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>df4.plot.bar(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Average Sales Ratio by Town&#39;</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Town&#39;</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Sales Ratio&#39;</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/var/folders/04/hdjfckkd4fd__5521d_kggjh0000gn/T/ipykernel_53103/2815784812.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/af9e26eb8cc890ab786e83b6fd6c9140952b6271.png"
width="3000" height="1000" /></p>
</div>
</div>
<div id="415a98ab" class="cell code">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of bar graph</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df4.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="325">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>salesratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>169.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.624507</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.084827</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.380444</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.595276</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.613225</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.641801</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.494922</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="c582fd81" class="cell markdown">
<p>From the graph summary, we can find that an upper outlier = Q3 +
1.5<em>IQR = 0.640661 + 1.5</em>(0.640661-0.595011) = 0.709136. We can
then refer to the bar graph to find any towns that have sales ratio
values that exceed the upper outlier values. To make it easier to
identify these values, let's plot a horizontal line on our bar graph at
y=0.709136.</p>
</div>
<div id="47bc0900" class="cell code">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df4.plot.bar(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Average Sales Ratio by Town&#39;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Town&#39;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Sales Ratio&#39;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add a horizontal line y=0.709136 to plt</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="fl">0.709136</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/d4553061815d4e5ea33e997a682f6d4aadcbcfc4.png" /></p>
</div>
</div>
<div id="26dbe8f7" class="cell markdown">
<p>We can easily identify the towns that have average sales ratios that
are noticeably higher than the rest: Chaplin, Colebrook, Haddam,
Hartland, New Hartford, Scotland, Somers, and Thompson. Knowing this, we
can include town as a factor that more likely affects sales ratios of
real-estate in Connecticut (and to sales ratios in general).</p>
</div>
<div id="3f98de8a" class="cell markdown">
<p>We can further explore the effect of location on sales ratio by
creating a map of plotted addresses of real-estate units in Connecticut
and focusing on the distribution of spread of sales ratios. We're going
to make a map of each house's location, using its longitude (y_coord)
and latitude (x_coord) values, and label each point/marker with its
address name, on a map of Connecticut. This way, we can get a better
visual of where houses are generally located in the state.</p>
</div>
<div id="e80fa5e1" class="cell code">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of bar graph</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df4.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="327">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>salesratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>169.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.624507</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.084827</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.380444</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.595276</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.613225</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.641801</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.494922</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="c582fd81" class="cell markdown">
<p>From the graph summary, we can find that an upper outlier = Q3 +
1.5<em>IQR = 0.640661 + 1.5</em>(0.640661-0.595011) = 0.709136. We can
then refer to the bar graph to find any towns that have sales ratio
values that exceed the upper outlier values. To make it easier to
identify these values, let's plot a horizontal line on our bar graph at
y=0.709136.</p>
</div>
<div id="47bc0900" class="cell code">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/d4553061815d4e5ea33e997a682f6d4aadcbcfc4.png" /></p>
</div>
</div>
<div id="26dbe8f7" class="cell markdown">
<p>We can easily identify the towns that have average sales ratios that
are noticeably higher than the rest: Chaplin, Colebrook, Haddam,
Hartland, New Hartford, Scotland, Somers, and Thompson. Knowing this, we
can include town as a factor that more likely affects sales ratios of
real-estate in Connecticut (and to sales ratios in general).</p>
</div>
<div id="dd1163c1" class="cell markdown">
<p>We can further explore the effect of location on sales ratio by
creating a map of plotted addresses of real-estate units in Connecticut
and focusing on the distribution of spread of sales ratios.</p>
</div>
<div id="75a081cd" class="cell markdown">
<p>We're going to make a map of each house's location, using its
longitude (y_coord) and latitude (x_coord) values, and label each
point/marker with its address name. This way, we can get a better visual
of where houses are generally located in Connecticut.</p>
</div>
<div id="af0a4dbc" class="cell code">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all rows with nan as x_coord or y_coord</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df5 <span class="op">=</span> df_merge.dropna(subset<span class="op">=</span>[<span class="st">&#39;x_coord&#39;</span>, <span class="st">&#39;y_coord&#39;</span>])<span class="op">\</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a map centered on connecticut</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> folium.Map(location<span class="op">=</span>[<span class="fl">41.6</span>, <span class="op">-</span><span class="fl">72.7</span>], zoom_start<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot all addresses on the map</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> df5.iterrows():</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    folium.CircleMarker(</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        [row[<span class="st">&#39;y_coord&#39;</span>], row[<span class="st">&#39;x_coord&#39;</span>]],</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        radius<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>row[<span class="st">&#39;salesratio&#39;</span>],</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">&#39;blue&#39;</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        fill<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        fill_color<span class="op">=</span><span class="st">&#39;#3186cc&#39;</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        fill_opacity<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>row[<span class="st">&#39;salesratio&#39;</span>]</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    ).add_to(m)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<div class="output error" data-ename="NameError"
data-evalue="name &#39;folium&#39; is not defined">
<pre><code>---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
Cell In[329], line 5
      2 df5 = df_merge.dropna(subset=[&#39;x_coord&#39;, &#39;y_coord&#39;])\
      4 # create a map centered on connecticut
----&gt; 5 m = folium.Map(location=[41.6, -72.7], zoom_start=9)
      7 # plot all addresses on the map
      8 for i, row in df5.iterrows():

NameError: name &#39;folium&#39; is not defined
</code></pre>
</div>
</div>
<div id="fbc61a72" class="cell markdown">
<p>Now we can see the relative locations of each address on a map of
Connecticut, with their sales ratios visible when we hover over each
point. The map looks so cool to code up! But it would be more helpful if
we could see each address's sales ratio more explicitly. Why don't we
plot the points onto a graph with x_coord and y_coord as our axes, and
include a color scale to indicate how high/low the points' sales ratios
are? Let's try it out!</p>
</div>
<div id="7bfd8acb" class="cell code">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates a scatter plot of x_coord vs y_coord, where the color of the points is determined by the salesratio</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df_merge.plot.scatter(x<span class="op">=</span><span class="st">&#39;x_coord&#39;</span>, y<span class="op">=</span><span class="st">&#39;y_coord&#39;</span>, c<span class="op">=</span><span class="st">&#39;salesratio&#39;</span>, colormap<span class="op">=</span><span class="st">&#39;inferno&#39;</span>, figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Sales Ratio by Location&#39;</span>, s<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;x_coord&#39;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;y_coord&#39;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/c1bada44f34f93f31737bba28e3ea9c47275642e.png"
width="2000" height="1000" /></p>
</div>
</div>
<div id="07a36673" class="cell markdown">
<p>Now we can see that the real-estate units with a lower sales ratio
are clustered around the bottom left and the center of Connecticut.
Observing this graph, we can further support that the location of the
real-estate unit is likely to have an impact on the sales ratio of the
unit.</p>
</div>
<div id="47935a25" class="cell markdown">
<p>Other factors that could potentially correlate with real estate sales
include the unemployment rate, as discussed above. So, how can we
examine this relationship? We can plot the unemployment rates in
relationship to the sales ratio and try to observe a relationship
between the two.</p>
</div>
<div id="7bfd8acb" class="cell code">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unemployment rate vs sales ratio labels</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Unemployment Rate vs Sales ratio&quot;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Unemployment Rate (%)&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Sales Ratio&quot;</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot unemployment rate vs sales ratio in a scatter plot</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(df_merge[<span class="st">&#39;UnemploymentRate&#39;</span>], df_merge[<span class="st">&#39;salesratio&#39;</span>])</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create a linear regression line and plot it</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.polyfit(df_merge[<span class="st">&#39;UnemploymentRate&#39;</span>], df_merge[<span class="st">&#39;salesratio&#39;</span>], <span class="dv">1</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>plt.plot(df_merge[<span class="st">&#39;UnemploymentRate&#39;</span>],p(df_merge[<span class="st">&#39;UnemploymentRate&#39;</span>]),<span class="st">&quot;r&quot;</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/fe4825fac2f698e9a8cf920fc07039df68f3577a.png"
width="2000" height="1000" /></p>
</div>
</div>
<div id="1994299e" class="cell markdown">
<p>Looking at the points without the linear regression line, we can
already see that there is a slightly positive relationship between
unemployment rate and the sales ratio, although not completely clear.
This is highlighted in the linear regression line because there is a
clear positive slope in the line. Thus we have established that there is
a slight positive correlation between these two variables.</p>
</div>
<div id="9e6c6ad2" class="cell code">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get a copy of the dataframe</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_merge.copy()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cast type of unemployment rate to object</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;UnemploymentRate&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;UnemploymentRate&#39;</span>].astype(<span class="bu">object</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a violin plot of the points for each discrete unemployment rate</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df, mapping<span class="op">=</span>aes(x<span class="op">=</span><span class="st">&#39;UnemploymentRate&#39;</span>, y<span class="op">=</span><span class="st">&#39;salesratio&#39;</span>)) <span class="op">+\</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>geom_violin() <span class="op">+\</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>labs(title<span class="op">=</span><span class="st">&quot;Unemployment Rate vs. Sales Ratio&quot;</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>     x <span class="op">=</span> <span class="st">&quot;Unemployment Rate&quot;</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>     y <span class="op">=</span> <span class="st">&quot;Sales Ratio&quot;</span>),</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/110d0fd09e216657d05f89e4812b96b6d48a789a.png"
width="640" height="480" /></p>
</div>
<div class="output execute_result" data-execution_count="517">
<pre><code>(&lt;Figure Size: (640 x 480)&gt;,)</code></pre>
</div>
</div>
<div id="0d2b6860" class="cell markdown">
<p>Next, we examine the relationship between interest rate and real
estate sales. So if we make a scatter plot of the relationship between
interest rate and real estate, we can better observe what sort of
relationship exists between the two by observing overall trends.</p>
</div>
<div id="45fb5b75" class="cell code">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot interest rate vs sales ratio</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Interest Rate vs Sales ratio&quot;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Interest Rate (%)&quot;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Sales Ratio&quot;</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a scatter plot</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(df_merge[<span class="st">&#39;primeRate&#39;</span>], df_merge[<span class="st">&#39;salesratio&#39;</span>])</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create a linear regression line </span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.polyfit(df_merge[<span class="st">&#39;primeRate&#39;</span>], df_merge[<span class="st">&#39;salesratio&#39;</span>], <span class="dv">1</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.poly1d(z)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>plt.plot(df_merge[<span class="st">&#39;primeRate&#39;</span>],p(df_merge[<span class="st">&#39;primeRate&#39;</span>]),<span class="st">&quot;r&quot;</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/f18668fea695a3b5cccf1458e452cfc4985ef829.png"
width="2000" height="1000" /></p>
</div>
</div>
<div id="94a572f3" class="cell markdown">
<p>In this graph, there does also appear to be a relationship between
interest rate and sales; however, this relationship is negative. This
relationship is also very subtle and is harder to observe without the
linear regression line. A good majority of the points appear a distance
away from the linear regression line and the points are all spread out
in very similar ranges for each discrete interest rate.</p>
</div>
<div id="545e9036" class="cell code">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a copy of the dataframe</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_merge.copy()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cast type to object</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;primeRate&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;primeRate&#39;</span>].astype(<span class="bu">object</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make violin plot of interest rate vs sales ratio</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>ggplot(data<span class="op">=</span>df, mapping<span class="op">=</span>aes(x<span class="op">=</span><span class="st">&#39;primeRate&#39;</span>, y<span class="op">=</span><span class="st">&#39;salesratio&#39;</span>)) <span class="op">+\</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>geom_violin() <span class="op">+\</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>labs(title<span class="op">=</span><span class="st">&quot;Interest Rate vs. Sales ratio&quot;</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>     x <span class="op">=</span> <span class="st">&quot;Interest Rate&quot;</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>     y <span class="op">=</span> <span class="st">&quot;Sales Ratio&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/ba4dcc97008473715bdfa1a9ae19bc1b5b456d96.png"
width="640" height="480" /></p>
</div>
<div class="output execute_result" data-execution_count="519">
<pre><code>&lt;Figure Size: (640 x 480)&gt;</code></pre>
</div>
</div>
<div id="3d29345a" class="cell markdown">
<p>On the violin plot, the negative relationship is made slightly more
clear since we can see where the bulk of the points are distributed
across the interest rates and it does seem to clearly indicate that the
bulk of the points seem to shift downwards as the interest rates
decrease.</p>
</div>
<div id="74421e3b" class="cell markdown">
<p>From the above line graph, we can see each town's sales ratio vs
time. We can see that each town's sales ratios tend to hover between 0.3
and 1.3 throughout 2001-2020. Also, the sales ratios for each town are
more similar in value towards 2001, and vary more towards 2020. Was
there a general trend? Perhaps there was a slightly positive trend,
where the average sales ratio across all towns increased. Other than
that, we can see that each line representing a town tends to fluctuate
up and down more suddenly, rather than increasing/decreasing slowly.
This finding supports that there are other factors at play in shaping
the sales ratio in each town besides time.</p>
</div>
<div id="29592c50" class="cell markdown">
<h2 id="hypothesis-testing">Hypothesis Testing</h2>
</div>
<div id="80600807" class="cell markdown">
<p>Now that we've gained a better understanding of the dataset through
analysis of various factors' impact on sales ratio, let's move onto
Hypothesis Testing!</p>
</div>
<div id="a61db851" class="cell markdown">
<p>Our null hypothesis is that there is no relationship between sales
ratio and the given factor.</p>
<p>Some alternative hypotheses we can make are:</p>
<ol>
<li>Sales ratio is correlated with location</li>
<li>Sales ratio is correlated with unemployment rate</li>
<li>Sales ratio is correlated with interest rate</li>
</ol>
</div>
<div id="1bfb07ca" class="cell markdown">
<hr />
<p>Null hypothesis: There is no relationship between sales ratio and
location.</p>
<p>Alternative hypothesis 2: Sales ratio is correlated with
location.</p>
<p>Let's figure out if we should reject the null hypothesis and accept
the alternative hypothesis 2!</p>
</div>
<div id="53264206" class="cell code">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TO DO, + post markdown comment</span></span></code></pre></div>
</div>
<div id="44077589" class="cell markdown">
<hr />
<p>Null hypothesis: There is no relationship between sales ratio and
unemployment rate.</p>
<p>Alternative hypothesis 2: Sales ratio is correlated with unemployment
rate.</p>
<p>Let's figure out if we should reject the null hypothesis and accept
the alternative hypothesis 2!</p>
</div>
<div id="c6fc35cf" class="cell code">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">&quot;salesratio ~ UnemploymentRate&quot;</span>, data<span class="op">=</span>df_merge).fit()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div>
<div class="output execute_result" data-execution_count="213">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>salesratio</td>    <th>  R-squared:         </th> <td>   0.118</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.118</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   945.2</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 12 May 2023</td> <th>  Prob (F-statistic):</th> <td>6.25e-195</td>
</tr>
<tr>
  <th>Time:</th>                 <td>20:14:53</td>     <th>  Log-Likelihood:    </th> <td>  2758.5</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  7074</td>      <th>  AIC:               </th> <td>  -5513.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  7072</td>      <th>  BIC:               </th> <td>  -5499.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
          <td></td>            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>        <td>    0.5234</td> <td>    0.003</td> <td>  158.854</td> <td> 0.000</td> <td>    0.517</td> <td>    0.530</td>
</tr>
<tr>
  <th>UnemploymentRate</th> <td>    0.0034</td> <td>    0.000</td> <td>   30.744</td> <td> 0.000</td> <td>    0.003</td> <td>    0.004</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>1375.674</td> <th>  Durbin-Watson:     </th> <td>   1.322</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>5108.473</td>
</tr>
<tr>
  <th>Skew:</th>           <td> 0.940</td>  <th>  Prob(JB):          </th> <td>    0.00</td>
</tr>
<tr>
  <th>Kurtosis:</th>       <td> 6.715</td>  <th>  Cond. No.          </th> <td>    50.2</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div id="60523ab2" class="cell markdown">
<p>The p-value for the coefficient of unemployment rate is 0.000, which
is less than alpha=0.05. This suggests that there is a statistically
significant relationship between sales ratio and unemployment rate, so
we should reject the null hypothesis and accept alternative hypothesis
2.</p>
</div>
<div id="68357424" class="cell markdown">
<hr />
<p>Null hypothesis: There is no relationship between sales ratio and
interest rate.</p>
<p>Alternative hypothesis 3: Sales ratio is correlated with interest
rate.</p>
<p>Let's figure out if we should reject the null hypothesis and accept
the alternative hypothesis 3!</p>
</div>
<div id="df7e8d31" class="cell code">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">&quot;salesratio ~ primeRate&quot;</span>, data<span class="op">=</span>df_merge).fit()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div>
<div class="output execute_result" data-execution_count="212">
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>salesratio</td>    <th>  R-squared:         </th> <td>   0.142</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.142</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   1168.</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 12 May 2023</td> <th>  Prob (F-statistic):</th> <td>4.38e-237</td>
</tr>
<tr>
  <th>Time:</th>                 <td>20:14:40</td>     <th>  Log-Likelihood:    </th> <td>  2855.5</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  7074</td>      <th>  AIC:               </th> <td>  -5707.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  7072</td>      <th>  BIC:               </th> <td>  -5693.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>    0.8008</td> <td>    0.006</td> <td>  132.578</td> <td> 0.000</td> <td>    0.789</td> <td>    0.813</td>
</tr>
<tr>
  <th>primeRate</th> <td>   -0.0424</td> <td>    0.001</td> <td>  -34.178</td> <td> 0.000</td> <td>   -0.045</td> <td>   -0.040</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>1428.558</td> <th>  Durbin-Watson:     </th> <td>   1.357</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th>  <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>5663.661</td>
</tr>
<tr>
  <th>Skew:</th>           <td> 0.956</td>  <th>  Prob(JB):          </th> <td>    0.00</td>
</tr>
<tr>
  <th>Kurtosis:</th>       <td> 6.945</td>  <th>  Cond. No.          </th> <td>    15.9</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div id="9a205199" class="cell markdown">
<p>The p-value for the coefficient of prime (interest) rate is 0.000,
which is less than alpha=0.05. This suggests that there is a
statistically significant relationship between sales ratio and interest
rate, so we should reject the null hypothesis and accept alternative
hypothesis 3.</p>
</div>
<div id="d1c72a0f" class="cell markdown">
<h2 id="machine-learning">Machine Learning</h2>
</div>
<div id="3a9c29db" class="cell code">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize the towns column of df_merge using sklearn</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>le.fit(df_merge[<span class="st">&#39;town&#39;</span>])</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>df_merge[<span class="st">&#39;town&#39;</span>] <span class="op">=</span> le.transform(df_merge[<span class="st">&#39;town&#39;</span>])</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize the residentialtype column of df_merge using sklearn</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>le.fit(df_merge[<span class="st">&#39;residentialtype&#39;</span>])</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>df_merge[<span class="st">&#39;residentialtype&#39;</span>] <span class="op">=</span> le.transform(df_merge[<span class="st">&#39;residentialtype&#39;</span>])</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>df_merge</span></code></pre></div>
<div class="output execute_result" data-execution_count="200">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>listyear</th>
      <th>daterecorded</th>
      <th>town</th>
      <th>address</th>
      <th>assessedvalue</th>
      <th>saleamount</th>
      <th>salesratio</th>
      <th>propertytype</th>
      <th>residentialtype</th>
      <th>nonusecode</th>
      <th>Year</th>
      <th>Month</th>
      <th>x_coord</th>
      <th>y_coord</th>
      <th>UnemploymentRate</th>
      <th>primeRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>2020-10-05</td>
      <td>0</td>
      <td>303 LAKE RD</td>
      <td>2008</td>
      <td>210000.0</td>
      <td>0.577600</td>
      <td>Residential</td>
      <td>2</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.35327</td>
      <td>41.71416</td>
      <td>46</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>2020-10-23</td>
      <td>3</td>
      <td>21 CLIFF DRIVE</td>
      <td>2801</td>
      <td>249000.0</td>
      <td>0.624000</td>
      <td>Residential</td>
      <td>2</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.87619</td>
      <td>41.80986</td>
      <td>46</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>2020-10-09</td>
      <td>5</td>
      <td>19 SUSAN STREET</td>
      <td>195</td>
      <td>45000.0</td>
      <td>0.725300</td>
      <td>Residential</td>
      <td>2</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>2020-10-13</td>
      <td>8</td>
      <td>57 CHESTNUT STREET</td>
      <td>3480</td>
      <td>365000.0</td>
      <td>0.531800</td>
      <td>Residential</td>
      <td>2</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-73.40632</td>
      <td>41.36916</td>
      <td>46</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>2020-10-21</td>
      <td>13</td>
      <td>2E ANCHOR REEF</td>
      <td>4190</td>
      <td>480000.0</td>
      <td>0.533300</td>
      <td>Residential</td>
      <td>0</td>
      <td>NaN</td>
      <td>2020</td>
      <td>10</td>
      <td>-72.67344</td>
      <td>41.72606</td>
      <td>46</td>
      <td>3.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7069</th>
      <td>2001</td>
      <td>2002-03-20</td>
      <td>142</td>
      <td>616 MIGEON AVE UT 10</td>
      <td>55</td>
      <td>32900.0</td>
      <td>0.519757</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>7070</th>
      <td>2001</td>
      <td>2002-03-25</td>
      <td>143</td>
      <td>6 PEPPERIDGE RD</td>
      <td>3055</td>
      <td>309900.0</td>
      <td>0.543724</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>7071</th>
      <td>2001</td>
      <td>2002-03-01</td>
      <td>157</td>
      <td>92 NEWTOWN TPKE</td>
      <td>4890</td>
      <td>635000.0</td>
      <td>0.607717</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>7072</th>
      <td>2001</td>
      <td>2002-03-11</td>
      <td>158</td>
      <td>703 RIDGE RD</td>
      <td>2272</td>
      <td>245000.0</td>
      <td>0.536327</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>4.75</td>
    </tr>
    <tr>
      <th>7073</th>
      <td>2001</td>
      <td>2002-03-27</td>
      <td>166</td>
      <td>27 RICHARD SWEET DR</td>
      <td>4558</td>
      <td>439000.0</td>
      <td>0.700797</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>2002</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>4.75</td>
    </tr>
  </tbody>
</table>
<p>7074 rows × 16 columns</p>
</div>
</div>
</div>
<div id="0b711abf" class="cell code">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>relevant_cols <span class="op">=</span> df_merge[[<span class="st">&#39;salesratio&#39;</span>, <span class="st">&#39;UnemploymentRate&#39;</span>, <span class="st">&#39;primeRate&#39;</span>, <span class="st">&#39;town&#39;</span>, <span class="st">&#39;residentialtype&#39;</span>]]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>relevant_cols <span class="op">=</span> relevant_cols.dropna(subset<span class="op">=</span>[<span class="st">&#39;salesratio&#39;</span>, <span class="st">&#39;UnemploymentRate&#39;</span>, <span class="st">&#39;primeRate&#39;</span>, <span class="st">&#39;town&#39;</span>, <span class="st">&#39;residentialtype&#39;</span>])</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># combine all sales ratio, unemployment rate, and interest rate grouped by year for better visualization</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>ml_df <span class="op">=</span> relevant_cols[[<span class="st">&#39;UnemploymentRate&#39;</span>, <span class="st">&#39;primeRate&#39;</span>, <span class="st">&#39;town&#39;</span>, <span class="st">&#39;residentialtype&#39;</span>, <span class="st">&#39;salesratio&#39;</span>]].groupby(by<span class="op">=</span>[<span class="st">&#39;town&#39;</span>], as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>ml_df.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="266">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UnemploymentRate</th>
      <th>primeRate</th>
      <th>town</th>
      <th>residentialtype</th>
      <th>salesratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>3.25</td>
      <td>0</td>
      <td>2</td>
      <td>0.577600</td>
    </tr>
    <tr>
      <th>1</th>
      <td>46</td>
      <td>3.25</td>
      <td>3</td>
      <td>2</td>
      <td>0.624000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>3.25</td>
      <td>5</td>
      <td>2</td>
      <td>0.725300</td>
    </tr>
    <tr>
      <th>3</th>
      <td>46</td>
      <td>3.25</td>
      <td>8</td>
      <td>2</td>
      <td>0.531800</td>
    </tr>
    <tr>
      <th>4</th>
      <td>46</td>
      <td>3.25</td>
      <td>13</td>
      <td>0</td>
      <td>0.533300</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6965</th>
      <td>12</td>
      <td>4.75</td>
      <td>25</td>
      <td>5</td>
      <td>0.408800</td>
    </tr>
    <tr>
      <th>7009</th>
      <td>1</td>
      <td>5.50</td>
      <td>12</td>
      <td>5</td>
      <td>0.575189</td>
    </tr>
    <tr>
      <th>7019</th>
      <td>1</td>
      <td>5.50</td>
      <td>67</td>
      <td>5</td>
      <td>0.468841</td>
    </tr>
    <tr>
      <th>7023</th>
      <td>1</td>
      <td>5.50</td>
      <td>86</td>
      <td>5</td>
      <td>0.582040</td>
    </tr>
    <tr>
      <th>7061</th>
      <td>6</td>
      <td>4.75</td>
      <td>124</td>
      <td>5</td>
      <td>0.449714</td>
    </tr>
  </tbody>
</table>
<p>1535 rows × 5 columns</p>
</div>
</div>
</div>
<div id="2fd9c7cf" class="cell code">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># function for modeling with linear regression</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelLinReg(X, Y):</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># split the data into training/testing sets</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create linear regression object</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> linear_model.LinearRegression()</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># train the model using the training sets</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  model.fit(X_train, Y_train)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make predictions using the testing set</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  Y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Ordinary Least Squares (OLS)&#39;</span>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficients: &#39;</span>, model.coef_[<span class="dv">0</span>])</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Intercept: &#39;</span>, model.intercept_)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Mean squared error: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> mean_squared_error(Y_test, Y_pred))</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficient of determination: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> r2_score(Y_test, Y_pred))</span></code></pre></div>
</div>
<div id="8d25f523" class="cell code">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for modeling with ridge regression</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelRidgeReg(X, Y):</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># split the data into training/testing sets</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create linear regression object</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> linear_model.Ridge(alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># train the model using the training sets</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  model.fit(X_train, Y_train)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make predictions using the testing set</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  Y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Ridge Regression&#39;</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficients: &#39;</span>, model.coef_[<span class="dv">0</span>])</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Intercept: &#39;</span>, model.intercept_)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Mean squared error: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> mean_squared_error(Y_test, Y_pred))</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficient of determination: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> r2_score(Y_test, Y_pred))</span></code></pre></div>
</div>
<div id="716cf405" class="cell code">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for modeling with lasso regression</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelLassoReg(X, Y):</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># split the data into training/testing sets</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create linear regression object</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> linear_model.Lasso(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># train the model using the training sets</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  model.fit(X_train, Y_train)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make predictions using the testing set</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  Y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Lasso Regression&#39;</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficients: &#39;</span>, model.coef_[<span class="dv">0</span>])</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Intercept: &#39;</span>, model.intercept_)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Mean squared error: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> mean_squared_error(Y_test, Y_pred))</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficient of determination: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> r2_score(Y_test, Y_pred))</span></code></pre></div>
</div>
<div id="1dbdd715" class="cell code">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for modeling with elastic net regression</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> modelElasticNetReg(X, Y):</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># split the data into training/testing sets</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create linear regression object</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  model <span class="op">=</span> linear_model.ElasticNet(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># train the model using the training sets</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  model.fit(X_train, Y_train)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make predictions using the testing set</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  Y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Elastic Net Regression&#39;</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficients: &#39;</span>, model.coef_[<span class="dv">0</span>])</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Intercept: &#39;</span>, model.intercept_)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Mean squared error: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> mean_squared_error(Y_test, Y_pred))</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Coefficient of determination: </span><span class="sc">%.2f</span><span class="st">&#39;</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">%</span> r2_score(Y_test, Y_pred))</span></code></pre></div>
</div>
<div id="dc3c20ee" class="cell code" data-execution_count="275">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(df_merge[[<span class="st">&#39;UnemploymentRate&#39;</span>, <span class="st">&#39;primeRate&#39;</span>, <span class="st">&#39;residentialtype&#39;</span>, <span class="st">&#39;town&#39;</span>]])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array(df_merge[[<span class="st">&#39;salesratio&#39;</span>]])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>modelLinReg(X, Y)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>modelRidgeReg(X, Y)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>modelLassoReg(X, Y)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>modelElasticNetReg(X, Y)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Ordinary Least Squares (OLS)
Coefficients:  [ 0.0010291  -0.02316451 -0.03244144 -0.00011672]
Intercept:  [0.79385828]
Mean squared error: 0.02
Coefficient of determination: 0.27


Ridge Regression
Coefficients:  [ 1.00692376e-03 -2.38438584e-02 -3.19109917e-02 -2.36004104e-05]
Intercept:  [0.78928174]
Mean squared error: 0.02
Coefficient of determination: 0.28


Lasso Regression
Coefficients:  0.003035298441493321
Intercept:  [0.53674553]
Mean squared error: 0.03
Coefficient of determination: 0.13


Elastic Net Regression
Coefficients:  0.0027242910687823333
Intercept:  [0.59394055]
Mean squared error: 0.02
Coefficient of determination: 0.19


</code></pre>
</div>
</div>
<div id="f567f9a3" class="cell code" data-execution_count="276">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font_scale<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>sns.pairplot(ml_df, height<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="output error" data-ename="TypeError"
data-evalue="&#39;data&#39; must be pandas DataFrame object, not: &lt;class &#39;pandas.core.groupby.generic.DataFrameGroupBy&#39;&gt;">
<pre><code>---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
Cell In[276], line 4
      1 import seaborn as sns
      3 sns.set(font_scale=2.5)
----&gt; 4 sns.pairplot(ml_df, height=10)

File ~/Documents/cmsc320/lib/python3.10/site-packages/seaborn/axisgrid.py:2098, in pairplot(data, hue, hue_order, palette, vars, x_vars, y_vars, kind, diag_kind, markers, height, aspect, corner, dropna, plot_kws, diag_kws, grid_kws, size)
   2095     warnings.warn(msg, UserWarning)
   2097 if not isinstance(data, pd.DataFrame):
-&gt; 2098     raise TypeError(
   2099         f&quot;&#39;data&#39; must be pandas DataFrame object, not: {type(data)}&quot;)
   2101 plot_kws = {} if plot_kws is None else plot_kws.copy()
   2102 diag_kws = {} if diag_kws is None else diag_kws.copy()

TypeError: &#39;data&#39; must be pandas DataFrame object, not: &lt;class &#39;pandas.core.groupby.generic.DataFrameGroupBy&#39;&gt;
</code></pre>
</div>
</div>
<div id="051e2851" class="cell code" data-execution_count="278">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a linear regression model for sales ratio = m1 * unemployment rate + m2 * prime rate + m3 * town + m4 * residential type + b</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">&quot;salesratio ~ UnemploymentRate + primeRate + town + residentialtype&quot;</span>, data<span class="op">=</span>ml_df).fit()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div>
<div class="output error" data-ename="ValueError"
data-evalue="setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (169, 2) + inhomogeneous part.">
<pre><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
Cell In[278], line 2
      1 # make a linear regression model for sales ratio = m1 * unemployment rate + m2 * prime rate + m3 * town + m4 * residential type + b
----&gt; 2 model = smf.ols(formula=&quot;salesratio ~ UnemploymentRate + primeRate + town + residentialtype&quot;, data=ml_df).fit()
      3 model.summary()

File ~/Documents/cmsc320/lib/python3.10/site-packages/statsmodels/base/model.py:203, in Model.from_formula(cls, formula, data, subset, drop_cols, *args, **kwargs)
    200 if missing == &#39;none&#39;:  # with patsy it&#39;s drop or raise. let&#39;s raise.
    201     missing = &#39;raise&#39;
--&gt; 203 tmp = handle_formula_data(data, None, formula, depth=eval_env,
    204                           missing=missing)
    205 ((endog, exog), missing_idx, design_info) = tmp
    206 max_endog = cls._formula_max_endog

File ~/Documents/cmsc320/lib/python3.10/site-packages/statsmodels/formula/formulatools.py:66, in handle_formula_data(Y, X, formula, depth, missing)
     63         result = dmatrices(formula, Y, depth, return_type=&#39;dataframe&#39;,
     64                            NA_action=na_action)
     65     else:
---&gt; 66         result = dmatrices(formula, Y, depth, return_type=&#39;dataframe&#39;,
     67                            NA_action=na_action)
     69 # if missing == &#39;raise&#39; there&#39;s not missing_mask
     70 missing_mask = getattr(na_action, &#39;missing_mask&#39;, None)

File ~/Documents/cmsc320/lib/python3.10/site-packages/patsy/highlevel.py:309, in dmatrices(formula_like, data, eval_env, NA_action, return_type)
    299 &quot;&quot;&quot;Construct two design matrices given a formula_like and data.
    300 
    301 This function is identical to :func:`dmatrix`, except that it requires
   (...)
    306 See :func:`dmatrix` for details.
    307 &quot;&quot;&quot;
    308 eval_env = EvalEnvironment.capture(eval_env, reference=1)
--&gt; 309 (lhs, rhs) = _do_highlevel_design(formula_like, data, eval_env,
    310                                   NA_action, return_type)
    311 if lhs.shape[1] == 0:
    312     raise PatsyError(&quot;model is missing required outcome variables&quot;)

File ~/Documents/cmsc320/lib/python3.10/site-packages/patsy/highlevel.py:164, in _do_highlevel_design(formula_like, data, eval_env, NA_action, return_type)
    162 def data_iter_maker():
    163     return iter([data])
--&gt; 164 design_infos = _try_incr_builders(formula_like, data_iter_maker, eval_env,
    165                                   NA_action)
    166 if design_infos is not None:
    167     return build_design_matrices(design_infos, data,
    168                                  NA_action=NA_action,
    169                                  return_type=return_type)

File ~/Documents/cmsc320/lib/python3.10/site-packages/patsy/highlevel.py:66, in _try_incr_builders(formula_like, data_iter_maker, eval_env, NA_action)
     64 if isinstance(formula_like, ModelDesc):
     65     assert isinstance(eval_env, EvalEnvironment)
---&gt; 66     return design_matrix_builders([formula_like.lhs_termlist,
     67                                    formula_like.rhs_termlist],
     68                                   data_iter_maker,
     69                                   eval_env,
     70                                   NA_action)
     71 else:
     72     return None

File ~/Documents/cmsc320/lib/python3.10/site-packages/patsy/build.py:693, in design_matrix_builders(termlists, data_iter_maker, eval_env, NA_action)
    689 factor_states = _factors_memorize(all_factors, data_iter_maker, eval_env)
    690 # Now all the factors have working eval methods, so we can evaluate them
    691 # on some data to find out what type of data they return.
    692 (num_column_counts,
--&gt; 693  cat_levels_contrasts) = _examine_factor_types(all_factors,
    694                                                factor_states,
    695                                                data_iter_maker,
    696                                                NA_action)
    697 # Now we need the factor infos, which encapsulate the knowledge of
    698 # how to turn any given factor into a chunk of data:
    699 factor_infos = {}

File ~/Documents/cmsc320/lib/python3.10/site-packages/patsy/build.py:444, in _examine_factor_types(factors, factor_states, data_iter_maker, NA_action)
    442 for factor in list(examine_needed):
    443     value = factor.eval(factor_states[factor], data)
--&gt; 444     if factor in cat_sniffers or guess_categorical(value):
    445         if factor not in cat_sniffers:
    446             cat_sniffers[factor] = CategoricalSniffer(NA_action,
    447                                                       factor.origin)

File ~/Documents/cmsc320/lib/python3.10/site-packages/patsy/categorical.py:130, in guess_categorical(data)
    128 if isinstance(data, _CategoricalBox):
    129     return True
--&gt; 130 data = np.asarray(data)
    131 if safe_issubdtype(data.dtype, np.number):
    132     return False

ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (169, 2) + inhomogeneous part.
</code></pre>
</div>
</div>
<div id="3fff777e" class="cell code">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="ca719647" class="cell markdown">
<h2 id="step-5-interpretation-insight--policy-decision">Step 5:
Interpretation: Insight &amp; Policy Decision</h2>
</div>
<div id="fdc273dc" class="cell markdown">
<p>Looking at the various factors that could influence real-estate sale
ratios, .</p>
<p>This tutorial is a simplification of the complex nature of the
real-estate market, and the predictions are not to be followed blindly.
We would rather encourage you to use them as a base level of
understanding and as a bounceboard for further studying the influences
on the real-estate market.</p>
<p>With this tutorial, we hope to have brought you insight into how to
pull observations from multiple datasets to draw relationships between
specific factors, and finding which model is the most useful for
analyzing which factors are most relevant and should be considered the
most when it comes to participating in market transactions. And most
importantly, we hope that this tutorial brought you a new excitement for
the possibilities that data science opens up, for topics as simple as
predicting your future grades, to this project, and beyond!</p>
<p>For more resources and data on the real-estate market, please refer
to</p>
</div>
<div id="3ee6755f" class="cell markdown">
<h2 id="appendices">Appendices</h2>
</div>
<div id="e9acdbef" class="cell code">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>res_type_df<span class="op">=</span> results_df.groupby(<span class="st">&#39;residentialtype&#39;</span>).first()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>res_type_df[<span class="st">&#39;COUNT&#39;</span>] <span class="op">=</span> results_df[<span class="st">&#39;residentialtype&#39;</span>].value_counts()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>res_type_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>res_type_df<span class="op">=</span> res_type_df[[<span class="st">&#39;residentialtype&#39;</span>,<span class="st">&#39;COUNT&#39;</span>]]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(res_type_df[<span class="st">&#39;residentialtype&#39;</span>])</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">data = res_type_df[&#39;COUNT&#39;].values.tolist()</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">types = res_type_df[&#39;residentialtype&#39;].values.tolist()</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">fig = plt.figure(figsize =(10, 7))</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">plt.pie(data, labels = types)</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"> </span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">plt.show()&quot;&quot;&quot;</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>explode <span class="op">=</span> (<span class="fl">0.1</span>, <span class="fl">0.0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating color parameters</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> ( <span class="st">&quot;khaki&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;mistyrose&quot;</span>,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;springgreen&quot;</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> res_type_df[<span class="st">&#39;COUNT&#39;</span>].values.tolist()</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>types <span class="op">=</span> res_type_df[<span class="st">&#39;residentialtype&#39;</span>].values.tolist()</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>wp <span class="op">=</span> { <span class="st">&#39;linewidth&#39;</span> : <span class="dv">1</span>, <span class="st">&#39;edgecolor&#39;</span> : <span class="st">&quot;green&quot;</span> }</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> func(pct, allvalues):</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    absolute <span class="op">=</span> <span class="bu">int</span>(pct <span class="op">/</span> <span class="fl">100.</span><span class="op">*</span>np.<span class="bu">sum</span>(allvalues))</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&quot;</span><span class="sc">{:.1f}</span><span class="st">%</span><span class="ch">\n</span><span class="st">(</span><span class="sc">{:d}</span><span class="st">)&quot;</span>.<span class="bu">format</span>(pct, absolute)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating plot</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>wedges, texts, autotexts <span class="op">=</span> ax.pie(data,</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>                                  autopct <span class="op">=</span> <span class="kw">lambda</span> pct: func(pct, data),</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>                                  explode <span class="op">=</span> explode,</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>                                  labels <span class="op">=</span> types,</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>                                  shadow <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>                                  colors <span class="op">=</span> colors,</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>                                  startangle <span class="op">=</span> <span class="dv">90</span>,</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>                                  wedgeprops <span class="op">=</span> wp,</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>                                  textprops <span class="op">=</span> <span class="bu">dict</span>(color <span class="op">=</span><span class="st">&quot;black&quot;</span>))</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding legend</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>ax.legend(wedges, types,</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>          title <span class="op">=</span><span class="st">&quot;Residential Types&quot;</span>,</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>          loc <span class="op">=</span><span class="st">&quot;center left&quot;</span>,</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>          bbox_to_anchor <span class="op">=</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>plt.setp(autotexts, size <span class="op">=</span> <span class="dv">8</span>, weight <span class="op">=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&quot;Percentage of Residential Types for All Towns</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0            Condo
1      Four Family
2    Single Family
3     Three Family
4       Two Family
Name: residentialtype, dtype: object
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/20c8236d1aa128b6b7ab5c56c93b9d6cf8ebd64a.png"
width="1000" height="700" /></p>
</div>
</div>
<div id="1c9345b4" class="cell markdown">
<p>We can also observe that the least popular type of home sale was the
Four Family, accounting for only 0.3% of the total sales, and the most
popular type of home sale was the Single Family, accounting for 73.6% of
total sales.</p>
</div>
<div id="016f2452" class="cell markdown">
<p>We will then create a bar graph of for each of the resident types
showing which town purchased the most real estate and showing the most
popular residence type.</p>
</div>
<div id="2c76a581" class="cell code">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">type</span> <span class="kw">in</span> cleanedList:</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    temp_df <span class="op">=</span> temp[<span class="bu">type</span>]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Turn on the grid</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    temp_df.plot.bar(figsize<span class="op">=</span>(<span class="dv">70</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Number of &#39;</span> <span class="op">+</span> <span class="bu">type</span> <span class="op">+</span> <span class="st">&#39; Homes for each Town&#39;</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Town&#39;</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Number of &#39;</span> <span class="op">+</span> <span class="bu">type</span> <span class="op">+</span> <span class="st">&#39; Sales&#39;</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output error" data-ename="NameError"
data-evalue="name &#39;temp&#39; is not defined">
<pre><code>---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
Cell In[180], line 3
      1 for type in cleanedList:
----&gt; 3     temp_df = temp[type]
      5     # Turn on the grid
      6     temp_df.plot.bar(figsize=(70,10), title=&#39;Number of &#39; + type + &#39; Homes for each Town&#39;)

NameError: name &#39;temp&#39; is not defined
</code></pre>
</div>
</div>
<div id="e9103d0d" class="cell markdown">
<p>We can observe from each of these graphs the towns with the highest
amount of Single Family, Two Family, Condo, Four Family, and Three
Family are Waterbury, Bridgeport, Stamford, Killingly, and Waterbury
respectively.</p>
</div>
<div id="b096bafb" class="cell markdown">
<p>Next, we graphed each unique town with its average assessed value of
houses, to get an overall assessment of the average value of homes as
seen from their assessed amount in each town.</p>
</div>
<div id="d0574bb5" class="cell code">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make table with just town and assessedvalue columns</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df_merge[[<span class="st">&#39;town&#39;</span>, <span class="st">&#39;assessedvalue&#39;</span>]]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># group by town and average the assessedvalue</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.groupby(<span class="st">&#39;town&#39;</span>).mean()</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the rows where town is &#39;***Unknown***&#39;</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2[df2.index <span class="op">!=</span> <span class="st">&#39;***Unknown***&#39;</span>]</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>df2.head()</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graph with town vs assessedvalue</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>df2.plot.bar(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Average Assessed Value by Town&#39;</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Town&#39;</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Assessed Value (in hundred thousands)&#39;</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/b88fbcf43638e28018e6b5316d90fa72cf0d6050.png"
width="3000" height="1000" /></p>
</div>
</div>
<div id="cc750093" class="cell markdown">
<p>As we can see from the bar graph above, the average assessed value
for homes in most towns is within the ranges of $150,000 and $300,000.
From this graph, we can also observe that there are towns with a
signficantly higher average assessed value of homes, such as Darien,
Greenwich, New Canaan, etc.</p>
</div>
<div id="3818dbfd" class="cell markdown">
<p>Next, we graphed each unique town with its average sale amount of
houses, to get an overall assessment of the average value of homes as
seen from their sale amount in each town.</p>
</div>
<div id="d68c8bd5" class="cell code">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make table with just town and saleamount columns</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df_merge[[<span class="st">&#39;town&#39;</span>, <span class="st">&#39;saleamount&#39;</span>]]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># group by town and average the saleamount</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df3.groupby(<span class="st">&#39;town&#39;</span>).mean()</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the rows where town is &#39;***Unknown***&#39;</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df3[df3.index <span class="op">!=</span> <span class="st">&#39;***Unknown***&#39;</span>]</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>df3.head()</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># bar graph with town vs saleamount</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>df3.plot.bar(figsize<span class="op">=</span>(<span class="dv">30</span>,<span class="dv">10</span>), title<span class="op">=</span><span class="st">&#39;Average Sale Amount by Town&#39;</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Town&#39;</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Sale Amount&#39;</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/40ab6876a365f9086c132d0faca9862a02da4363.png" /></p>
</div>
</div>
<div id="2a955abb" class="cell markdown">
<p>As we can see from the bar graph above, the average sales amount for
homes in most towns is within the ranges of $200,000 and $400,000, a
range that is shifted up from the average assessed values' range. From
this graph, we can also observe that the towns with a signficantly
higher average assessed value of homes, such as Darien, Greenwich, New
Canaan, follow with the signficantly higher sales amounts as well.</p>
</div>
<div id="7eb2e617" class="cell code">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the DataFrame by &#39;listyear&#39; and calculate the mean &#39;saleamount&#39;</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>grouped_df <span class="op">=</span> df_merge.groupby(<span class="st">&#39;listyear&#39;</span>)[<span class="st">&#39;saleamount&#39;</span>].mean()</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique years</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> np.unique(df[<span class="st">&#39;listyear&#39;</span>])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">17</span>, <span class="dv">15</span>))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>plt.plot(years, grouped_df.values)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Sale amount&#39;</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Sale Amount over Time&quot;</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/ed86cc2ec052ed7a06b190857c1093d193b5b8be.png" /></p>
</div>
</div>
<div id="aad3d9b3" class="cell markdown">
<p>From the graph above, we can see that the housing market had a sharp
and steady increase from 2001 to 2006 and dropped sharply afterwards.
Then, the market peaked again in 2011 before hitting a low in 2015.
Since 2015, the housing sale amounts have slowly increased and have not
yet returned to the highest peak around 2006.</p>
</div>
<div id="64e27f2e" class="cell markdown">
<p>Now we'll make a line graph of sales ratio over time for all towns.
What do you expect to see in this line graph? Will there be a general
trend of increasing or decreasing sales ratio over time? Let's code it
up and take a look!</p>
</div>
<div id="dc63f9e1" class="cell code">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot each town&#39;s salesratio vs time onto a line graph</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> town <span class="kw">in</span> df_merge[<span class="st">&#39;town&#39;</span>].unique():</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    df_town <span class="op">=</span> df_merge[df_merge[<span class="st">&#39;town&#39;</span>] <span class="op">==</span> town]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    df_town.sort_values(by<span class="op">=</span><span class="st">&#39;Year&#39;</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(df_town[<span class="st">&#39;Year&#39;</span>], df_town[<span class="st">&#39;salesratio&#39;</span>], label<span class="op">=</span>town)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Year&#39;</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Sales Ratio&#39;</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Sales Ratio over Time&quot;</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>C:\Users\helen\AppData\Local\Temp\ipykernel_14968\682255871.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_efc8821642c54c9793d4861b9b77ec51/7aa97f77c8ed59996286798103dd68fd39db3214.png" /></p>
</div>
</div>
</body>
</html>
